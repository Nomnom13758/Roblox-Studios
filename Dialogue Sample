-- GUI 
local DialogueGUI = script.Parent.Parent.Parent
local GuiFrame = DialogueGUI["Text Box"]
local TextFrame = script.Parent
local ResponseButton1 = GuiFrame.Response1
local ResponseButton2 = GuiFrame.Response2
local replicatedStorage = game:GetService("ReplicatedStorage")
local EventLog = replicatedStorage.Events.TestDialogue

-- Sounds/Music
local DefaultMusic = DialogueGUI["Sounds/Music"].BackgroundMusic
local DefaultSound = DialogueGUI["Sounds/Music"].TypingSound

-- variables
local Typing = false
local Dialogue = false
local StartMessage = 1 

-- Message and Response table
local Messages = {
	[1] = "Hello World",
	[2] = nil
}

local response1 = {
	[1] = "Place Holder!",
	[2] = nil
}

local response2 = {
	[1] = "Place Holder!",
	[2] = nil
}


-- Messaging/Writing script
local function TextInput(messages:string)
	if messages == nil or response1 == nil or response2 == nil then
		DialogueGUI.Enabled = false
		Typing = false
		Dialogue = false
		StartMessage = 1
		DefaultMusic:stop()
	end
	DialogueGUI.Enabled = true 
	Dialogue = true 
	Typing = true 
	
	
	TextFrame.Text = ""
	ResponseButton1.Text = ""
	ResponseButton2.Text = ""
	
	-- Messages being typed out 
	for i, v in messages:split("") do
		TextFrame.Text = TextFrame.Text..v
		DefaultSound:Play()
		wait(0.05)
	end
	Typing = false
end

EventLog.OnClientEvent:Connect(function()
	TextInput(Messages[StartMessage])
	DefaultMusic:Play()
end)

ResponseButton1.MouseButton1Up:Connect(function()
	if Typing == true then return end
	if Dialogue == false then return end
	TextInput(response1[StartMessage])
	StartMessage = StartMessage + 1 
end)

ResponseButton2.MouseButton1Up:Connect(function()
	if Typing == true then return end
	if Dialogue == false then return end 
	TextInput(response2[StartMessage])
	StartMessage = StartMessage + 1 
end)


-- Server Script
local RS = game:GetService("ReplicatedStorage")
local clickEvent = RS.Events.Sans

local function onPlayerClick(player)
	clickEvent:FireClient(player)
end

local clickDetector = game.Workspace.SANSSSSS.ClickDetector
clickDetector.MouseClick:Connect(onPlayerClick)   
